{"ast":null,"code":"var _s = $RefreshSig$();\nimport axios from 'axios';\nimport { useEffect, useState } from 'react';\nimport { socket } from '../../../socket';\nconst useFriendlist = () => {\n  _s();\n  const [data, setdata] = useState([]);\n  const [onlineList, setOnlineList] = useState([]);\n  const [isLoading, setisLoading] = useState(true);\n  const [error, seterror] = useState();\n  const getFriends = async () => {\n    try {\n      setisLoading(true);\n      seterror();\n      const result = await axios.get('http://localhost:5001/user');\n      if (result) {\n        setdata(result.data.data);\n      }\n    } catch (error) {\n      var _error$response;\n      console.log('error in get message', (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data);\n      console.log(error);\n      seterror('an error has occured');\n    } finally {\n      setisLoading(false);\n    }\n  };\n  useEffect(() => {\n    getFriends();\n  }, []);\n  function onOnlineRec(online) {\n    // alert('hoy')\n    console.log('online', online);\n    console.log('data', data);\n    if (data && data.length !== 0) {\n      console.log('new list', data.map(friend => {\n        if (online.indexOf(friend.id) !== -1) {\n          friend.online = true;\n          return friend;\n        } else {\n          friend.online = false;\n          return friend;\n        }\n      }));\n      setdata(data.map(friend => {\n        if (online.indexOf(friend.id) !== -1) {\n          friend.online = true;\n          return friend;\n        } else {\n          friend.online = false;\n          return friend;\n        }\n      }));\n    }\n  }\n  useEffect(() => {\n    // Socket receive\n\n    socket.on('receive_online', onOnlineRec);\n    return () => {\n      socket.off('receive_online', onOnlineRec);\n    };\n  }, [data]);\n  return {\n    data,\n    isLoading,\n    error,\n    onlineList\n  };\n};\n_s(useFriendlist, \"2pT0OS9R6z2ZTXKdRIpp0UJiXP8=\");\nexport default useFriendlist;","map":{"version":3,"names":["axios","useEffect","useState","socket","useFriendlist","_s","data","setdata","onlineList","setOnlineList","isLoading","setisLoading","error","seterror","getFriends","result","get","_error$response","console","log","response","onOnlineRec","online","length","map","friend","indexOf","id","on","off"],"sources":["/home/saafi/Desktop/Personal/websock/front/src/pages/friendlist/logic/useFriendlist.js"],"sourcesContent":["import axios from 'axios'\nimport { useEffect, useState } from 'react'\nimport { socket } from '../../../socket'\n\nconst useFriendlist = () => {\n\n\n\n    const [data, setdata] = useState([])\n    const [onlineList, setOnlineList] = useState([])\n    const [isLoading, setisLoading] = useState(true)\n    const [error, seterror] = useState()\n\n    const getFriends = async () => {\n        try {\n            setisLoading(true)\n            seterror()\n\n            const result = await axios.get('http://localhost:5001/user');\n            if (result) {\n                setdata(result.data.data)\n            }\n        } catch (error) {\n            console.log('error in get message', error.response?.data)\n            console.log(error)\n            seterror('an error has occured')\n        } finally {\n            setisLoading(false)\n        }\n    }\n\n\n    useEffect(() => {\n        getFriends()\n\n    }, [])\n\n\n    function onOnlineRec(online) {\n        // alert('hoy')\n        console.log('online',online)\n        console.log('data',data)\n        if (data && data.length !== 0) {\n            console.log('new list',data.map((friend) => {\n                if (online.indexOf(friend.id) !== -1) {\n                    friend.online = true;\n                    return friend;\n                } else {\n                    friend.online = false;\n                    return friend;\n                }\n            }))\n            setdata(data.map((friend) => {\n                if (online.indexOf(friend.id) !== -1) {\n                    friend.online = true;\n                    return friend;\n                } else {\n                    friend.online = false;\n                    return friend;\n                }\n            }))\n        }\n    }\n    useEffect(() => {\n\n        // Socket receive\n        \n\n        socket.on('receive_online', onOnlineRec);\n\n        return () => {\n            socket.off('receive_online', onOnlineRec);\n        }\n    },[data])\n\n    return {\n        data,\n        isLoading,\n        error,\n        onlineList\n\n    }\n}\n\nexport default useFriendlist"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}