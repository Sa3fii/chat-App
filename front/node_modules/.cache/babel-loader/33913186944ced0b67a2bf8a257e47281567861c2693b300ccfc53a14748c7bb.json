{"ast":null,"code":"var _s = $RefreshSig$();\nimport axios from 'axios';\nimport { useContext, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { AppAuthContext } from '../../../core/contexts/AppAuthProvider';\nimport { decodeJwt } from 'jose';\nconst useLogin = () => {\n  _s();\n  const [password, setPassword] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [passwordError, setpasswordError] = useState(\"\");\n  const [emailError, setemailError] = useState(\"\");\n  const {\n    setUserToken,\n    userToken,\n    setUserID\n  } = useContext(AppAuthContext);\n  const navigate = useNavigate();\n  const handleValidation = event => {\n    let formIsValid = true;\n    if (!email.match(/^[a-zA-Z_]{3,20}$/)) {\n      formIsValid = false;\n      setemailError(\"Username Not Valid\");\n      return false;\n    } else {\n      setemailError(\"\");\n      formIsValid = true;\n    }\n    if (!password.match(/^[a-zA-Z1-9]{2,22}$/)) {\n      formIsValid = false;\n      setpasswordError(\" length must best min 2 Characters \");\n      return false;\n    } else {\n      setpasswordError(\"\");\n      formIsValid = true;\n    }\n    return formIsValid;\n  };\n  const loginSubmit = async e => {\n    try {\n      e.preventDefault();\n      const valid = handleValidation();\n      if (valid) {\n        const result = await axios.post('http://localhost:5001/user/signin', {\n          name: email,\n          password\n        });\n        if (result.data.statusCode == 7000) {\n          setUserToken(result.data.data);\n          const decoded = decodeJwt(userToken, 'barabaw');\n          setUserID(decoded.id);\n          navigate('/home');\n        }\n        ;\n      }\n    } catch (error) {\n      console.log(error);\n      if (error.response.data.statusCode === 7001) {\n        setemailError('User not Found');\n      }\n      if (error.response.data.statusCode === 7003) {\n        setpasswordError('Invalid Password');\n      }\n    }\n  };\n  return {\n    loginSubmit,\n    setEmail,\n    emailError,\n    setPassword,\n    passwordError\n  };\n};\n_s(useLogin, \"aFvewG0haAodqZLiLHaj0YiPRdQ=\", false, function () {\n  return [useNavigate];\n});\nexport default useLogin;","map":{"version":3,"names":["axios","useContext","useState","useNavigate","AppAuthContext","decodeJwt","useLogin","_s","password","setPassword","email","setEmail","passwordError","setpasswordError","emailError","setemailError","setUserToken","userToken","setUserID","navigate","handleValidation","event","formIsValid","match","loginSubmit","e","preventDefault","valid","result","post","name","data","statusCode","decoded","id","error","console","log","response"],"sources":["/home/saafi/Desktop/Personal/websock/front/src/pages/login/logic/useLogin.js"],"sourcesContent":["import axios from 'axios';\nimport { useContext, useState } from 'react'\nimport { useNavigate } from 'react-router-dom';\nimport { AppAuthContext } from '../../../core/contexts/AppAuthProvider';\nimport { decodeJwt } from 'jose';\n\n\nconst useLogin = () => {\n\n    const [password, setPassword] = useState(\"\");\n    const [email, setEmail] = useState(\"\");\n    const [passwordError, setpasswordError] = useState(\"\");\n    const [emailError, setemailError] = useState(\"\");\n\n    const { setUserToken, userToken, setUserID } = useContext(AppAuthContext)\n\n    const navigate = useNavigate();\n\n    const handleValidation = (event) => {\n        let formIsValid = true;\n\n        if (!email.match(/^[a-zA-Z_]{3,20}$/)) {\n            formIsValid = false;\n            setemailError(\"Username Not Valid\");\n            return false;\n        } else {\n            setemailError(\"\");\n            formIsValid = true;\n        }\n\n        if (!password.match(/^[a-zA-Z1-9]{2,22}$/)) {\n            formIsValid = false;\n            setpasswordError(\n                \" length must best min 2 Characters \"\n            );\n            return false;\n        } else {\n            setpasswordError(\"\");\n            formIsValid = true;\n        }\n\n        return formIsValid;\n    };\n\n    const loginSubmit = async (e) => {\n        try {\n            e.preventDefault();\n            const valid = handleValidation();\n            if (valid) {\n                const result = await axios.post('http://localhost:5001/user/signin', { name: email, password })\n                if (result.data.statusCode == 7000) {\n                    setUserToken(result.data.data)\n                    const decoded = decodeJwt(userToken, 'barabaw');\n                    setUserID(decoded.id);\n                    navigate('/home')\n                };\n\n            }\n        } catch (error) {\n            console.log(error)\n            if (error.response.data.statusCode === 7001) {\n                setemailError('User not Found')\n            }\n            if (error.response.data.statusCode === 7003) {\n                setpasswordError('Invalid Password')\n            }\n        }\n\n    };\n\n    return {\n        loginSubmit,\n        setEmail,\n        emailError,\n        setPassword,\n        passwordError\n    }\n}\nexport default useLogin"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,UAAU,EAAEC,QAAQ,QAAQ,OAAO;AAC5C,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,cAAc,QAAQ,wCAAwC;AACvE,SAASC,SAAS,QAAQ,MAAM;AAGhC,MAAMC,QAAQ,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAEnB,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGP,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACQ,KAAK,EAAEC,QAAQ,CAAC,GAAGT,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACU,aAAa,EAAEC,gBAAgB,CAAC,GAAGX,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAACY,UAAU,EAAEC,aAAa,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EAEhD,MAAM;IAAEc,YAAY;IAAEC,SAAS;IAAEC;EAAU,CAAC,GAAGjB,UAAU,CAACG,cAAc,CAAC;EAEzE,MAAMe,QAAQ,GAAGhB,WAAW,CAAC,CAAC;EAE9B,MAAMiB,gBAAgB,GAAIC,KAAK,IAAK;IAChC,IAAIC,WAAW,GAAG,IAAI;IAEtB,IAAI,CAACZ,KAAK,CAACa,KAAK,CAAC,mBAAmB,CAAC,EAAE;MACnCD,WAAW,GAAG,KAAK;MACnBP,aAAa,CAAC,oBAAoB,CAAC;MACnC,OAAO,KAAK;IAChB,CAAC,MAAM;MACHA,aAAa,CAAC,EAAE,CAAC;MACjBO,WAAW,GAAG,IAAI;IACtB;IAEA,IAAI,CAACd,QAAQ,CAACe,KAAK,CAAC,qBAAqB,CAAC,EAAE;MACxCD,WAAW,GAAG,KAAK;MACnBT,gBAAgB,CACZ,qCACJ,CAAC;MACD,OAAO,KAAK;IAChB,CAAC,MAAM;MACHA,gBAAgB,CAAC,EAAE,CAAC;MACpBS,WAAW,GAAG,IAAI;IACtB;IAEA,OAAOA,WAAW;EACtB,CAAC;EAED,MAAME,WAAW,GAAG,MAAOC,CAAC,IAAK;IAC7B,IAAI;MACAA,CAAC,CAACC,cAAc,CAAC,CAAC;MAClB,MAAMC,KAAK,GAAGP,gBAAgB,CAAC,CAAC;MAChC,IAAIO,KAAK,EAAE;QACP,MAAMC,MAAM,GAAG,MAAM5B,KAAK,CAAC6B,IAAI,CAAC,mCAAmC,EAAE;UAAEC,IAAI,EAAEpB,KAAK;UAAEF;QAAS,CAAC,CAAC;QAC/F,IAAIoB,MAAM,CAACG,IAAI,CAACC,UAAU,IAAI,IAAI,EAAE;UAChChB,YAAY,CAACY,MAAM,CAACG,IAAI,CAACA,IAAI,CAAC;UAC9B,MAAME,OAAO,GAAG5B,SAAS,CAACY,SAAS,EAAE,SAAS,CAAC;UAC/CC,SAAS,CAACe,OAAO,CAACC,EAAE,CAAC;UACrBf,QAAQ,CAAC,OAAO,CAAC;QACrB;QAAC;MAEL;IACJ,CAAC,CAAC,OAAOgB,KAAK,EAAE;MACZC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;MAClB,IAAIA,KAAK,CAACG,QAAQ,CAACP,IAAI,CAACC,UAAU,KAAK,IAAI,EAAE;QACzCjB,aAAa,CAAC,gBAAgB,CAAC;MACnC;MACA,IAAIoB,KAAK,CAACG,QAAQ,CAACP,IAAI,CAACC,UAAU,KAAK,IAAI,EAAE;QACzCnB,gBAAgB,CAAC,kBAAkB,CAAC;MACxC;IACJ;EAEJ,CAAC;EAED,OAAO;IACHW,WAAW;IACXb,QAAQ;IACRG,UAAU;IACVL,WAAW;IACXG;EACJ,CAAC;AACL,CAAC;AAAAL,EAAA,CAtEKD,QAAQ;EAAA,QASOH,WAAW;AAAA;AA8DhC,eAAeG,QAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}